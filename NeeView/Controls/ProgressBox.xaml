<UserControl x:Class="NeeView.ProgressBox"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NeeView"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid x:Name="Root" Visibility="{Binding IsEnabled, Converter={StaticResource BooleanToVisibilityConverter}}">
        <Grid x:Name="Mask">
            <Grid.RowDefinitions>
                <RowDefinition Height="28"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="135" />
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <local:BooleanToInverseVisibilityConverter x:Key="BooleanToInverseVisibilityConverter"/>
                <Style x:Key="MaskStyle" TargetType="Border">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="IsHitTestVisible" Value="True"/>
                    <EventSetter Event="PreviewKeyDown" Handler="Root_PreviewKeyDown"/>
                </Style>
            </Grid.Resources>
            <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource MaskStyle}"/>
            <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource MaskStyle}" Visibility="{Binding RelativeSource={RelativeSource AncestorType=local:ProgressBox}, Path=HideMenu, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource MaskStyle}"/>
            <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource MaskStyle}"/>
        </Grid>
        <Border Background="{DynamicResource Toast.Background}" BorderBrush="{DynamicResource Toast.Border}" BorderThickness="1" HorizontalAlignment="Center" VerticalAlignment="Center" Width="400" MinHeight="100">
            <DockPanel Margin="20,10">
                <local:ProgressRing Margin="20,0,10,0" Radius="8" />
                <TextBlock x:Name="Message" Text="{Binding Message}" TextWrapping="Wrap" Foreground="{DynamicResource Toast.Foreground}" VerticalAlignment="Center" />
            </DockPanel>
        </Border>
    </Grid>
</UserControl>
